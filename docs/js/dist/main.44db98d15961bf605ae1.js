/*! For license information please see main.44db98d15961bf605ae1.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[58],{255:(e,t,r)=>{function n(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}r.d(t,{c:()=>n,o:()=>c,r:()=>u});var a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function s(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var c=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,n,c=s(e),l=1;l<arguments.length;l++){for(var u in r=Object(arguments[l]))o.call(r,u)&&(c[u]=r[u]);if(a){n=a(r);for(var m=0;m<n.length;m++)i.call(r,n[m])&&(c[n[m]]=r[n[m]])}}return c},l=n((function(e,t){var r=60103,n=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var a=60109,o=60110,i=60112;t.Suspense=60113;var s=60115,l=60116;if("function"==typeof Symbol&&Symbol.for){var u=Symbol.for;r=u("react.element"),n=u("react.portal"),t.Fragment=u("react.fragment"),t.StrictMode=u("react.strict_mode"),t.Profiler=u("react.profiler"),a=u("react.provider"),o=u("react.context"),i=u("react.forward_ref"),t.Suspense=u("react.suspense"),s=u("react.memo"),l=u("react.lazy")}var m="function"==typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},d={};function h(e,t,r){this.props=e,this.context=t,this.refs=d,this.updater=r||p}function v(){}function g(e,t,r){this.props=e,this.context=t,this.refs=d,this.updater=r||p}h.prototype.isReactComponent={},h.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},h.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=h.prototype;var y=g.prototype=new v;y.constructor=g,c(y,h.prototype),y.isPureReactComponent=!0;var E={current:null},w=Object.prototype.hasOwnProperty,b={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var a,o={},i=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,a)&&!b.hasOwnProperty(a)&&(o[a]=t[a]);var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===o[a]&&(o[a]=c[a]);return{$$typeof:r,type:e,key:i,ref:s,props:o,_owner:E.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var C=/\/+/g;function S(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function _(e,t,a,o,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return i=i(c=e),e=""===o?"."+S(c,0):o,Array.isArray(i)?(a="",null!=e&&(a=e.replace(C,"$&/")+"/"),_(i,t,a,"",(function(e){return e}))):null!=i&&(x(i)&&(i=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,a+(!i.key||c&&c.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+e)),t.push(i)),1;if(c=0,o=""===o?".":o+":",Array.isArray(e))for(var l=0;l<e.length;l++){var u=o+S(s=e[l],l);c+=_(s,t,a,u,i)}else if("function"==typeof(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e)))for(e=u.call(e),l=0;!(s=e.next()).done;)c+=_(s=s.value,t,a,u=o+S(s,l++),i);else if("object"===s)throw t=""+e,Error(f(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function N(e,t,r){if(null==e)return e;var n=[],a=0;return _(e,n,"","",(function(e){return t.call(r,e,a++)})),n}function $(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var P={current:null};function O(){var e=P.current;if(null===e)throw Error(f(321));return e}var R={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:c};t.Children={map:N,forEach:function(e,t,r){N(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error(f(143));return e}},t.Component=h,t.PureComponent=g,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.cloneElement=function(e,t,n){if(null==e)throw Error(f(267,e));var a=c({},e.props),o=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=E.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)w.call(t,u)&&!b.hasOwnProperty(u)&&(a[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)a.children=n;else if(1<u){l=Array(u);for(var m=0;m<u;m++)l[m]=arguments[m+2];a.children=l}return{$$typeof:r,type:e.type,key:o,ref:i,props:a,_owner:s}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:o,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:i,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:$}},t.memo=function(e,t){return{$$typeof:s,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return O().useCallback(e,t)},t.useContext=function(e,t){return O().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return O().useEffect(e,t)},t.useImperativeHandle=function(e,t,r){return O().useImperativeHandle(e,t,r)},t.useLayoutEffect=function(e,t){return O().useLayoutEffect(e,t)},t.useMemo=function(e,t){return O().useMemo(e,t)},t.useReducer=function(e,t,r){return O().useReducer(e,t,r)},t.useRef=function(e){return O().useRef(e)},t.useState=function(e){return O().useState(e)},t.version="17.0.2"})),u=n((function(e){e.exports=l}))},367:(e,t,r)=>{var n=r(255),a=n.r.useEffect,o=n.r.useRef,i=n.r.useState,s=r(616),c=r(460);function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}function m(){}function f(){}f.resetWarningCache=m;var p=(0,n.c)((function(e){e.exports=function(){function e(e,t,r,n,a,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:f,resetWarningCache:m};return r.PropTypes=r,r}()}));function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(e){return"/"===e.charAt(0)}function v(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function g(e,t){if(!e)throw new Error("Invariant failed")}function y(e){return"/"===e.charAt(0)?e:"/"+e}function E(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function w(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function b(e){var t=e.pathname,r=e.search,n=e.hash,a=t||"/";return r&&"?"!==r&&(a+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(a+="#"===n.charAt(0)?n:"#"+n),a}function k(e,t,r,n){var a;"string"==typeof e?(a=function(e){var t=e||"/",r="",n="",a=t.indexOf("#");-1!==a&&(n=t.substr(a),t=t.substr(0,a));var o=t.indexOf("?");return-1!==o&&(r=t.substr(o),t=t.substr(0,o)),{pathname:t,search:"?"===r?"":r,hash:"#"===n?"":n}}(e)).state=t:(void 0===(a=d({},e)).pathname&&(a.pathname=""),a.search?"?"!==a.search.charAt(0)&&(a.search="?"+a.search):a.search="",a.hash?"#"!==a.hash.charAt(0)&&(a.hash="#"+a.hash):a.hash="",void 0!==t&&void 0===a.state&&(a.state=t));try{a.pathname=decodeURI(a.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+a.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return r&&(a.key=r),n?a.pathname?"/"!==a.pathname.charAt(0)&&(a.pathname=function(e,t){void 0===t&&(t="");var r,n=e&&e.split("/")||[],a=t&&t.split("/")||[],o=e&&h(e),i=t&&h(t),s=o||i;if(e&&h(e)?a=n:n.length&&(a.pop(),a=a.concat(n)),!a.length)return"/";if(a.length){var c=a[a.length-1];r="."===c||".."===c||""===c}else r=!1;for(var l=0,u=a.length;u>=0;u--){var m=a[u];"."===m?v(a,u):".."===m?(v(a,u),l++):l&&(v(a,u),l--)}if(!s)for(;l--;l)a.unshift("..");!s||""===a[0]||a[0]&&h(a[0])||a.unshift("");var f=a.join("/");return r&&"/"!==f.substr(-1)&&(f+="/"),f}(a.pathname,n.pathname)):a.pathname=n.pathname:a.pathname||(a.pathname="/"),a}function x(){var e=null,t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,r,n,a){if(null!=e){var o="function"==typeof e?e(t,r):e;"string"==typeof o?"function"==typeof n?n(o,a):a(!0):a(!1!==o)}else a(!0)},appendListener:function(e){var r=!0;function n(){r&&e.apply(void 0,arguments)}return t.push(n),function(){r=!1,t=t.filter((function(e){return e!==n}))}},notifyListeners:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];t.forEach((function(e){return e.apply(void 0,r)}))}}}var C=!("undefined"==typeof window||!window.document||!window.document.createElement);function S(e,t){t(window.confirm(e))}var _="popstate",N="hashchange";function $(){try{return window.history.state||{}}catch(e){return{}}}function P(e){void 0===e&&(e={}),C||g(!1);var t,r=window.history,n=(-1===(t=window.navigator.userAgent).indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,a=!(-1===window.navigator.userAgent.indexOf("Trident")),o=e,i=o.forceRefresh,s=void 0!==i&&i,c=o.getUserConfirmation,l=void 0===c?S:c,u=o.keyLength,m=void 0===u?6:u,f=e.basename?w(y(e.basename)):"";function p(e){var t=e||{},r=t.key,n=t.state,a=window.location,o=a.pathname+a.search+a.hash;return f&&(o=E(o,f)),k(o,n,r)}function h(){return Math.random().toString(36).substr(2,m)}var v=x();function P(e){d(B,e),B.length=r.length,v.notifyListeners(B.location,B.action)}function O(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||j(p(e.state))}function R(){j(p($()))}var T=!1;function j(e){T?(T=!1,P()):v.confirmTransitionTo(e,"POP",l,(function(t){t?P({action:"POP",location:e}):function(e){var t=B.location,r=I.indexOf(t.key);-1===r&&(r=0);var n=I.indexOf(e.key);-1===n&&(n=0);var a=r-n;a&&(T=!0,L(a))}(e)}))}var A=p($()),I=[A.key];function M(e){return f+b(e)}function L(e){r.go(e)}var U=0;function F(e){1===(U+=e)&&1===e?(window.addEventListener(_,O),a&&window.addEventListener(N,R)):0===U&&(window.removeEventListener(_,O),a&&window.removeEventListener(N,R))}var D=!1,B={length:r.length,action:"POP",location:A,createHref:M,push:function(e,t){var a="PUSH",o=k(e,t,h(),B.location);v.confirmTransitionTo(o,a,l,(function(e){if(e){var t=M(o),i=o.key,c=o.state;if(n)if(r.pushState({key:i,state:c},null,t),s)window.location.href=t;else{var l=I.indexOf(B.location.key),u=I.slice(0,l+1);u.push(o.key),I=u,P({action:a,location:o})}else window.location.href=t}}))},replace:function(e,t){var a="REPLACE",o=k(e,t,h(),B.location);v.confirmTransitionTo(o,a,l,(function(e){if(e){var t=M(o),i=o.key,c=o.state;if(n)if(r.replaceState({key:i,state:c},null,t),s)window.location.replace(t);else{var l=I.indexOf(B.location.key);-1!==l&&(I[l]=o.key),P({action:a,location:o})}else window.location.replace(t)}}))},go:L,goBack:function(){L(-1)},goForward:function(){L(1)},block:function(e){void 0===e&&(e=!1);var t=v.setPrompt(e);return D||(F(1),D=!0),function(){return D&&(D=!1,F(-1)),t()}},listen:function(e){var t=v.appendListener(e);return F(1),function(){F(-1),t()}}};return B}var O=1073741823,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:{};function T(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(r,n){e=r,t.forEach((function(t){return t(e,n)}))}}}var j=n.r.createContext||function(e,t){var r,a,o="__create-react-context-"+(R["__global_unique_id__"]=(R.__global_unique_id__||0)+1)+"__",i=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).emitter=T(t.props.value),t}u(r,e);var n=r.prototype;return n.getChildContext=function(){var e;return(e={})[o]=this.emitter,e},n.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var r,n=this.props.value,a=e.value;!function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,a)?(r="function"==typeof t?t(n,a):O,0!=(r|=0)&&this.emitter.set(e.value,r)):r=0}},n.render=function(){return this.props.children},r}(n.r.Component);i.childContextTypes=((r={})[o]=p.object.isRequired,r);var s=function(t){function r(){var e;return(e=t.apply(this,arguments)||this).state={value:e.getValue()},e.onUpdate=function(t,r){0!=((0|e.observedBits)&r)&&e.setState({value:e.getValue()})},e}u(r,t);var n=r.prototype;return n.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?O:t},n.componentDidMount=function(){this.context[o]&&this.context[o].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?O:e},n.componentWillUnmount=function(){this.context[o]&&this.context[o].off(this.onUpdate)},n.getValue=function(){return this.context[o]?this.context[o].get():e},n.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},r}(n.r.Component);return s.contextTypes=((a={})[o]=p.object,a),{Provider:i,Consumer:s}},A=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},I=function e(t,r,n){return A(r)||(n=r||n,r=[]),n=n||{},t instanceof RegExp?function(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return H(e,t)}(t,r):A(t)?function(t,r,n){for(var a=[],o=0;o<t.length;o++)a.push(e(t[o],r,n).source);return H(new RegExp("(?:"+a.join("|")+")",z(n)),r)}(t,r,n):function(e,t,r){return Z(D(e,r),t,r)}(t,r,n)},M=D,L=q,U=Z,F=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function D(e,t){for(var r,n=[],a=0,o=0,i="",s=t&&t.delimiter||"/";null!=(r=F.exec(e));){var c=r[0],l=r[1],u=r.index;if(i+=e.slice(o,u),o=u+c.length,l)i+=l[1];else{var m=e[o],f=r[2],p=r[3],d=r[4],h=r[5],v=r[6],g=r[7];i&&(n.push(i),i="");var y=null!=f&&null!=m&&m!==f,E="+"===v||"*"===v,w="?"===v||"*"===v,b=r[2]||s,k=d||h;n.push({name:p||a++,prefix:f||"",delimiter:b,optional:w,repeat:E,partial:y,asterisk:!!g,pattern:k?W(k):g?".*":"[^"+V(b)+"]+?"})}}return o<e.length&&(i+=e.substr(o)),i&&n.push(i),n}function B(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function q(e,t){for(var r=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(r[n]=new RegExp("^(?:"+e[n].pattern+")$",z(t)));return function(t,n){for(var a="",o=t||{},i=(n||{}).pretty?B:encodeURIComponent,s=0;s<e.length;s++){var c=e[s];if("string"!=typeof c){var l,u=o[c.name];if(null==u){if(c.optional){c.partial&&(a+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(A(u)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(u)+"`");if(0===u.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var m=0;m<u.length;m++){if(l=i(u[m]),!r[s].test(l))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(l)+"`");a+=(0===m?c.prefix:c.delimiter)+l}}else{if(l=c.asterisk?encodeURI(u).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):i(u),!r[s].test(l))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+l+'"');a+=c.prefix+l}}else a+=c}return a}}function V(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function W(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function H(e,t){return e.keys=t,e}function z(e){return e&&e.sensitive?"":"i"}function Z(e,t,r){A(t)||(r=t||r,t=[]);for(var n=(r=r||{}).strict,a=!1!==r.end,o="",i=0;i<e.length;i++){var s=e[i];if("string"==typeof s)o+=V(s);else{var c=V(s.prefix),l="(?:"+s.pattern+")";t.push(s),s.repeat&&(l+="(?:"+c+l+")*"),o+=l=s.optional?s.partial?c+"("+l+")?":"(?:"+c+"("+l+"))?":c+"("+l+")"}}var u=V(r.delimiter||"/"),m=o.slice(-u.length)===u;return n||(o=(m?o.slice(0,-u.length):o)+"(?:"+u+"(?=$))?"),o+=a?"$":n&&m?"":"(?="+u+"|$)",H(new RegExp("^"+o,z(r)),t)}I.parse=M,I.compile=function(e,t){return q(D(e,t),t)},I.tokensToFunction=L,I.tokensToRegExp=U;var Y="function"==typeof Symbol&&Symbol.for,K=Y?Symbol.for("react.element"):60103,J=Y?Symbol.for("react.portal"):60106,G=Y?Symbol.for("react.fragment"):60107,Q=Y?Symbol.for("react.strict_mode"):60108,X=Y?Symbol.for("react.profiler"):60114,ee=Y?Symbol.for("react.provider"):60109,te=Y?Symbol.for("react.context"):60110,re=Y?Symbol.for("react.async_mode"):60111,ne=Y?Symbol.for("react.concurrent_mode"):60111,ae=Y?Symbol.for("react.forward_ref"):60112,oe=Y?Symbol.for("react.suspense"):60113,ie=Y?Symbol.for("react.suspense_list"):60120,se=Y?Symbol.for("react.memo"):60115,ce=Y?Symbol.for("react.lazy"):60116,le=Y?Symbol.for("react.block"):60121,ue=Y?Symbol.for("react.fundamental"):60117,me=Y?Symbol.for("react.responder"):60118,fe=Y?Symbol.for("react.scope"):60119;function pe(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case K:switch(e=e.type){case re:case ne:case G:case X:case Q:case oe:return e;default:switch(e=e&&e.$$typeof){case te:case ae:case ce:case se:case ee:return e;default:return t}}case J:return t}}}function de(e){return pe(e)===ne}var he={AsyncMode:re,ConcurrentMode:ne,ContextConsumer:te,ContextProvider:ee,Element:K,ForwardRef:ae,Fragment:G,Lazy:ce,Memo:se,Portal:J,Profiler:X,StrictMode:Q,Suspense:oe,isAsyncMode:function(e){return de(e)||pe(e)===re},isConcurrentMode:de,isContextConsumer:function(e){return pe(e)===te},isContextProvider:function(e){return pe(e)===ee},isElement:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===K},isForwardRef:function(e){return pe(e)===ae},isFragment:function(e){return pe(e)===G},isLazy:function(e){return pe(e)===ce},isMemo:function(e){return pe(e)===se},isPortal:function(e){return pe(e)===J},isProfiler:function(e){return pe(e)===X},isStrictMode:function(e){return pe(e)===Q},isSuspense:function(e){return pe(e)===oe},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===G||e===ne||e===X||e===Q||e===oe||e===ie||"object"==typeof e&&null!==e&&(e.$$typeof===ce||e.$$typeof===se||e.$$typeof===ee||e.$$typeof===te||e.$$typeof===ae||e.$$typeof===ue||e.$$typeof===me||e.$$typeof===fe||e.$$typeof===le)},typeOf:pe},ve=(0,n.c)((function(e){e.exports=he}));function ge(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}var ye={};ye[ve.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},ye[ve.Memo]={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0};var Ee=function(e){var t=j();return t.displayName="Router-History",t}(),we=function(e){var t=j();return t.displayName="Router",t}(),be=function(e){function t(t){var r;return(r=e.call(this,t)||this).state={location:t.history.location},r._isMounted=!1,r._pendingLocation=null,t.staticContext||(r.unlisten=t.history.listen((function(e){r._isMounted?r.setState({location:e}):r._pendingLocation=e}))),r}u(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var r=t.prototype;return r.componentDidMount=function(){this._isMounted=!0,this._pendingLocation&&this.setState({location:this._pendingLocation})},r.componentWillUnmount=function(){this.unlisten&&this.unlisten()},r.render=function(){return n.r.createElement(we.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},n.r.createElement(Ee.Provider,{children:this.props.children||null,value:this.props.history}))},t}(n.r.Component),ke=(n.r.Component,n.r.Component,{}),xe=0;function Ce(e,t){void 0===t&&(t={}),("string"==typeof t||Array.isArray(t))&&(t={path:t});var r=t,n=r.path,a=r.exact,o=void 0!==a&&a,i=r.strict,s=void 0!==i&&i,c=r.sensitive,l=void 0!==c&&c;return[].concat(n).reduce((function(t,r){if(!r&&""!==r)return null;if(t)return t;var n=function(e,t){var r=""+t.end+t.strict+t.sensitive,n=ke[r]||(ke[r]={});if(n[e])return n[e];var a=[],o={regexp:I(e,a,t),keys:a};return xe<1e4&&(n[e]=o,xe++),o}(r,{end:o,strict:s,sensitive:l}),a=n.regexp,i=n.keys,c=a.exec(e);if(!c)return null;var u=c[0],m=c.slice(1),f=e===u;return o&&!f?null:{path:r,url:"/"===r&&""===u?"/":u,isExact:f,params:i.reduce((function(e,t,r){return e[t.name]=m[r],e}),{})}}),null)}var Se=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.render=function(){var e=this;return n.r.createElement(we.Consumer,null,(function(t){t||g(!1);var r=e.props.location||t.location,a=d({},t,{location:r,match:e.props.computedMatch?e.props.computedMatch:e.props.path?Ce(r.pathname,e.props):t.match}),o=e.props,i=o.children,s=o.component,c=o.render;return Array.isArray(i)&&0===i.length&&(i=null),n.r.createElement(we.Provider,{value:a},a.match?i?"function"==typeof i?i(a):i:s?n.r.createElement(s,a):c?c(a):null:"function"==typeof i?i(a):null)}))},t}(n.r.Component);n.r.Component;var _e=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.render=function(){var e=this;return n.r.createElement(we.Consumer,null,(function(t){t||g(!1);var r,a,o=e.props.location||t.location;return n.r.Children.forEach(e.props.children,(function(e){if(null==a&&n.r.isValidElement(e)){r=e;var i=e.props.path||e.props.from;a=i?Ce(o.pathname,d({},e.props,{path:i})):t.match}})),a?n.r.cloneElement(r,{location:o,computedMatch:a}):null}))},t}(n.r.Component),Ne=n.r.useContext,$e=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this).history=P(t.props),t}return u(t,e),t.prototype.render=function(){return n.r.createElement(be,{history:this.history,children:this.props.children})},t}(n.r.Component),Pe=(n.r.Component,function(e,t){return"function"==typeof e?e(t):e}),Oe=function(e,t){return"string"==typeof e?k(e,null,null,t):e},Re=function(e){return e},Te=n.r.forwardRef;void 0===Te&&(Te=Re);var je=Te((function(e,t){var r=e.innerRef,a=e.navigate,o=e.onClick,i=ge(e,["innerRef","navigate","onClick"]),s=i.target,c=d({},i,{onClick:function(e){try{o&&o(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||s&&"_self"!==s||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),a())}});return c.ref=Re!==Te&&t||r,n.r.createElement("a",c)})),Ae=Te((function(e,t){var r=e.component,a=void 0===r?je:r,o=e.replace,i=e.to,s=e.innerRef,c=ge(e,["component","replace","to","innerRef"]);return n.r.createElement(we.Consumer,null,(function(e){e||g(!1);var r=e.history,l=Oe(Pe(i,e.location),e.location),u=l?r.createHref(l):"",m=d({},c,{href:u,navigate:function(){var t=Pe(i,e.location);(o?r.replace:r.push)(t)}});return Re!==Te?m.ref=t||s:m.innerRef=s,n.r.createElement(a,m)}))})),Ie=function(e){return e},Me=n.r.forwardRef;void 0===Me&&(Me=Ie),Me((function(e,t){var r=e["aria-current"],a=void 0===r?"page":r,o=e.activeClassName,i=void 0===o?"active":o,s=e.activeStyle,c=e.className,l=e.exact,u=e.isActive,m=e.location,f=e.sensitive,p=e.strict,h=e.style,v=e.to,y=e.innerRef,E=ge(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return n.r.createElement(we.Consumer,null,(function(e){e||g(!1);var r=m||e.location,o=Oe(Pe(v,r),r),w=o.pathname,b=w&&w.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),k=b?Ce(r.pathname,{path:b,exact:l,sensitive:f,strict:p}):null,x=!!(u?u(k,r):k),C=x?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((function(e){return e})).join(" ")}(c,i):c,S=x?d({},h,{},s):h,_=d({"aria-current":x&&a||null,className:C,style:S,to:o},E);return Ie!==Me?_.ref=t||y:_.innerRef=y,n.r.createElement(Ae,_)}))}));const Le=()=>n.r.createElement("div",{className:"Home"},n.r.createElement("div",{className:"article"},n.r.createElement("h1",null,"Supermosh: Datamoshing in the browser"),n.r.createElement("p",null,"Datamosh is the coolest video effect but it's currently a pain in the ass to achieve: you have to use software from 20 years ago, use the command line, and struggle with the complex technicalities of video codecs. Either this or pay for expensive datamosh plugins to even more expensive video editing tools."),n.r.createElement("p",null,"The mission of Supermosh is to empower artists to create interesting visuals while being restrained by neither the complexity of the underlying technology nor the price barrier. As such, Supermosh is:"),n.r.createElement("p",null,n.r.createElement("strong",null,"Simple"),": upload your videos, define your effects, download your edit. That's it."),n.r.createElement("p",null,n.r.createElement("strong",null,"Powerful"),": Supermosh allows you to preview your output and tweak parameters, unlike traditional datamoshing using Avidemux."),n.r.createElement("p",null,n.r.createElement("strong",null,"Free"),": and I mean, actually free, not free in exchange for personal data, an account creation, or anything."),n.r.createElement("p",null,"That being said, you are encouraged to mention me when posting Supermosh-generated visuals! I'm ",n.r.createElement("a",{href:"https://ninofiliu.com",target:"_blank",rel:"noreferrer noopener"},"Nino Filiu"),", I'm on ",n.r.createElement("a",{href:"https://www.instagram.com/ssttaacckkyy/",target:"_blank",rel:"noreferrer noopener"},"Instagram")," and ",n.r.createElement("a",{href:"https://twitter.com/ninofiliu",target:"_blank",rel:"noreferrer noopener"},"Twitter"),"."),n.r.createElement("div",{className:"ctas"},n.r.createElement(Ae,{className:"cta",to:"/studio"},n.r.createElement("img",{src:"/icons/studio.svg",alt:"studio icon"})," ","Start glitching"),n.r.createElement("a",{className:"cta",href:"https://youtu.be/1Hm_OtV2SSg",target:"_blank",rel:"noreferrer noopener"},n.r.createElement("img",{src:"/icons/tutorial.svg",alt:"tutorial icon"})," ","Watch tutorial"),n.r.createElement(Ae,{className:"cta",to:"/about"},n.r.createElement("img",{src:"/icons/info.svg",alt:"info icon"})," ","Learn more")),n.r.createElement("p",null,"Supermosh is currently in active development. If you spot a bug or have a feedback, please message me or"," ",n.r.createElement("a",{href:"https://github.com/supermosh/supermosh.github.io/issues",target:"_blank",rel:"noreferrer noopener"},"open an issue"),"!"),n.r.createElement("p",null,n.r.createElement("a",{href:"https://github.com/supermosh/supermosh.github.io",target:"_blank",rel:"noreferrer noopener"},"Source Code"))),n.r.createElement("div",{className:"media"},n.r.createElement("video",{src:"/media/bg.webm",muted:!0,autoPlay:!0,loop:!0,loading:"lazy"}))),Ue=()=>{const[e,t]=i(-1);return n.r.createElement("div",{className:"About"},n.r.createElement("div",{className:"article"},n.r.createElement("h1",null,"About Supermosh"),n.r.createElement("div",null,"Made with <3 by Nino Filiu"),n.r.createElement("div",null,n.r.createElement("a",{href:"https://ninofiliu.com",target:"_blank",rel:"noreferrer noopener"},"ninofiliu.com")),n.r.createElement("div",null,n.r.createElement("a",{href:"https://www.instagram.com/ssttaacckkyy/",target:"_blank",rel:"noreferrer noopener"},"instagram.com/ssttaacckkyy")),n.r.createElement("div",null,n.r.createElement("a",{href:"https://twitter.com/ninofiliu",target:"_blank",rel:"noreferrer noopener"},"twitter.com/ninofiliu")),n.r.createElement("div",null,n.r.createElement("a",{href:"mailto:nino.filiu@gmail.com",target:"_blank",rel:"noreferrer noopener"},"nino.filiu@gmail.com")),n.r.createElement("div",null,n.r.createElement("a",{href:"https://github.com/supermosh/supermosh.github.io",target:"_blank",rel:"noreferrer noopener"},"Source code")),n.r.createElement("section",{className:0===e?"--expanded":""},n.r.createElement("h2",{onClick:()=>t(0===e?-1:0),role:"button"},n.r.createElement("span",{className:"plus"},"[+]"),n.r.createElement("span",{className:"minus"},"[-]")," Is Supermosh free?"),n.r.createElement("div",{className:"section-content"},n.r.createElement("p",null,"Yes."),n.r.createElement("p",null,"Supermosh is completely free. Just go to ",n.r.createElement(Ae,{to:"/studio"},"the studio")," and start glitching."),n.r.createElement("p",null,"There is no hidden cost. You will not have to create an account. Your personal data will not be harvested. Supermosh will not use your computer to mine bitcoins in the background. Nothing."),n.r.createElement("p",null,"By coding Supermosh, I want to experiment, do something that has never been done before, and enable artists to get creative. I do not care about the money."),n.r.createElement("p",null,"That being said, you are encouraged to mention me when posting Supermosh-generated visuals! I'm on ",n.r.createElement("a",{href:"https://www.instagram.com/ssttaacckkyy/",target:"_blank",rel:"noreferrer noopener"},"Instagram")," and ",n.r.createElement("a",{href:"https://twitter.com/ninofiliu",target:"_blank",rel:"noreferrer noopener"},"Twitter"),"."))),n.r.createElement("section",{className:1===e?"--expanded":""},n.r.createElement("h2",{onClick:()=>t(1===e?-1:1)},n.r.createElement("span",{className:"plus"},"[+]"),n.r.createElement("span",{className:"minus"},"[-]")," What is datamoshing?"),n.r.createElement("div",{className:"section-content"},n.r.createElement("p",null,"Datamoshing is a category of special effects based on the deletion, repetition, and reordering or compressed video frames. There is no simpler way to put this, but if you are looking for technical details, here it goes:"),n.r.createElement("p",null,"The naïve way to encode a video would be to store on disk one image for every single frame of the video, but that would take a lot of disk space. Most videos are not random: often the current frame does not update a lot of pixels from the previous frame, we can just encode the movement and the color shift from the previous frame. Moreover we can often get away with describing only a fraction of the frames, and just say that whatever happens in between is a mix of what happens before and after."),n.r.createElement("p",null,"So most compression algorithms take advantage of these possible simplifications by encoding a video into a series of compressed frames that can be of three types:"),n.r.createElement("ul",null,n.r.createElement("li",null,"Intra frames, or I-frames: naïve copy of the uncompressed frame"),n.r.createElement("li",null,"Predicted frames, or P-frames: approximation of the current uncompressed frame based on the movement and color shift from some previous frame"),n.r.createElement("li",null,"Bidirectional frames, or B-frames: approximation of the current uncompressed frame based on a mix between some previous and future frame")),n.r.createElement("p",null,"So for example, the video of a ball falling on the ground would be compressed as such:"),n.r.createElement("ol",null,n.r.createElement("li",null,"i-frame: picture of the ball"),n.r.createElement("li",null,"b-frame: 75% frame 1, 25% frame 5"),n.r.createElement("li",null,"b-frame: 50% frame 1, 50% frame 5"),n.r.createElement("li",null,"b-frame: 25% frame 1, 75% frame 5"),n.r.createElement("li",null,"p-frame: frame 1 but the ball is 5 pixels lower"),n.r.createElement("li",null,"b-frame: 75% frame 5, 25% frame 9"),n.r.createElement("li",null,"b-frame: 50% frame 5, 50% frame 9"),n.r.createElement("li",null,"b-frame: 25% frame 5, 75% frame 9"),n.r.createElement("li",null,"p-frame: frame 5 but the ball is 10 pixels lower"),n.r.createElement("li",null,"...")),n.r.createElement("p",null,"I-frames are heavy but P-frames takes less bits to describe and B-frames take almost no disk space, so by having only a few I-frames, some P-frames, and as much B-frames as possible, the video is compressed. Let's forget about B-frames though, because they only complicate the understanding, but they often come up, so bear them in mind."),n.r.createElement("p",null,"Now what happens when we delete, re-order, or repeat some frames where they're not supposed to be? Datamosh, that's what happens."))),n.r.createElement("section",{className:2===e?"--expanded":""},n.r.createElement("h2",{onClick:()=>t(2===e?-1:2),role:"button"},n.r.createElement("span",{className:"plus"},"[+]"),n.r.createElement("span",{className:"minus"},"[-]")," What are typical datamosh effects?"),n.r.createElement("div",{className:"section-content"},n.r.createElement("p",null,n.r.createElement("strong",null,"Glide"),": one P-frame is copied several times instead of appearing just once, thus repeating a movement over and over"),n.r.createElement("p",null,n.r.createElement("strong",null,"Movement"),": an I-frame is deleted, making the P-frames afterward apply to the first part of the video, thus applying the movement of the second part to the image of the first part"))),n.r.createElement("section",{className:3===e?"--expanded":""},n.r.createElement("h2",{onClick:()=>t(3===e?-1:3),role:"button"},n.r.createElement("span",{className:"plus"},"[+]"),n.r.createElement("span",{className:"minus"},"[-]")," How is datamosh typically done?"),n.r.createElement("div",{className:"section-content"},n.r.createElement("p",null,"You can use existing software taylored for datamoshing but they are expensive. After Effects starts at $21/mo and the only datamoshing plugin available there costs $40."),n.r.createElement("p",null,"But you can do it manually, which is more interesting but also much more complex. First you have to convert your video to a codec where datamoshing is possible, typically using a command line tool like ",n.r.createElement("a",{href:"https://ffmpeg.org/",target:"_blank",rel:"noreferrer noopener"},"ffmpeg"),", because web-based conversions are rate-limited, malware-prone, and not tweakable enough."),n.r.createElement("p",null,"Then you would use ",n.r.createElement("a",{href:"http://avidemux.sourceforge.net/",target:"_blank",rel:"noreferrer noopener"},"Avidemux"),", a software from the early 2000s. You ",n.r.createElement("em",null,"have to use")," a software this old and broken, since modern software fixes your glitches... which is not what you want! Avidemux allows you to do frame-by-frame manipulation, but as soon as you start doing weird stuff, the preview window breaks. You have to export your video everytime in order to preview them."),n.r.createElement("p",null,"That is pretty much it but this journey is painful, expecially the part when you have to specify codec configurations to ffmpeg, because, besides the fact that ffmpeg is a pain in the ass to configure, that is when you really have to have precise technical knowledge on how compression algorithms work."))),n.r.createElement("section",{className:4===e?"--expanded":""},n.r.createElement("h2",{onClick:()=>t(4===e?-1:4),role:"button"},n.r.createElement("span",{className:"plus"},"[+]"),n.r.createElement("span",{className:"minus"},"[-]")," I have found a bug, what should I do?"),n.r.createElement("div",{className:"section-content"},n.r.createElement("p",null,"Supermosh is under active development in an experimental area of web technologies. There will be bugs, I know. If you found one, please report it!"),n.r.createElement("p",null,"You can contact me directly, or if you prefer you can ",n.r.createElement("a",{href:"https://github.com/supermosh/supermosh.github.io/issues",target:"_blank",rel:"noreferrer noopener"},"open an issue on Github"),".")))))},Fe=({children:e,onClose:t})=>n.r.createElement("div",{className:"Modal",onClick:()=>{t()}},n.r.createElement("div",{className:"box",onClick:e=>e.stopPropagation()},e)),De=16,Be=[0,1,-1,2,-2,4,-4,8,-8],qe=(e,t)=>{const{width:r,height:n}=e,a={};for(let o=0;o<r;o+=De){a[o]||(a[o]=[]);for(let i=0;i<n;i+=De){a[o][i]||(a[o][i]={x:NaN,y:NaN});const s=Math.min(o+De,r),c=Math.min(i+De,n);let l=1/0;for(const u of Be)for(const m of Be){let f=0;for(let a=o;a<s;a++)for(let o=i;o<c;o++){const i=4*(r*((o+m+n)%n)+(a+u+r)%r),s=4*(r*o+a);f+=Math.abs(e.data[i+0]-t.data[s+0]),f+=Math.abs(e.data[i+1]-t.data[s+1]),f+=Math.abs(e.data[i+2]-t.data[s+2])}f<l&&(l=f,a[o][i].x=u,a[o][i].y=m)}}}return a},Ve=(e,t)=>{const{width:r,height:n}=e,a=new ImageData(r,n);for(let e=3;e<a.data.length;e+=4)a.data[e]=255;for(let o=0;o<r;o+=De)for(let i=0;i<n;i+=De){const s=Math.min(o+De,r),c=Math.min(i+De,n);for(let l=o;l<s;l++)for(let s=i;s<c;s++){const c=(l+t[o][i].x+r)%r,u=4*(r*((s+t[o][i].y+n)%n)+c),m=4*(r*s+l);a.data[m+0]=e.data[u+0],a.data[m+1]=e.data[u+1],a.data[m+2]=e.data[u+2]}}return a},We=(e,t)=>new Promise((r=>{e.addEventListener(t,r,{once:!0})})),He=async(e,t)=>{const r=document.createElement("video");t.append(r),r.src=e.src,await We(r,"canplaythrough");const n=r.videoWidth,a=r.videoHeight,o=document.createElement("canvas");t.append(o),o.width=n,o.height=a;const i=o.getContext("2d");r.currentTime=e.time,await We(r,"seeked"),i.drawImage(r,0,0);const s=i.getImageData(0,0,n,a),c=await(async()=>{for(;!r.ended;){r.currentTime+=1/30,await We(r,"seeked"),await new Promise((e=>requestAnimationFrame(e))),i.drawImage(r,0,0);const e=i.getImageData(0,0,n,a);if(e.data.filter(((e,t)=>e!==s.data[t])).length>100)return e}throw new Error("All frames are almost identical")})(),l=qe(s,c);return r.remove(),o.remove(),{...e,shift:l}},ze=async(e,t,r)=>{const n=document.createElement("video");t.append(n),n.src=e.src,await We(n,"canplaythrough");const a=n.videoWidth,o=n.videoHeight,i=document.createElement("canvas");t.append(i),i.width=a,i.height=o;const s=i.getContext("2d");n.currentTime=e.start,await We(n,"seeked");const c=[];for(;n.currentTime<e.end;){s.drawImage(n,0,0);const t=s.getImageData(0,0,a,o);n.currentTime+=1/30,await We(n,"seeked"),s.drawImage(n,0,0);const i=s.getImageData(0,0,a,o);c.push(qe(t,i)),r&&r((n.currentTime-e.start)/(e.end-e.start))}return n.remove(),i.remove(),{...e,shifts:c}},Ze=async(e,t,r,n)=>{const a=document.createElement("video");for(a.src=e.src,r.append(a),await We(a,"canplaythrough"),a.currentTime=e.start,await We(a,"seeked");a.currentTime<e.end;)t.drawImage(a,0,0),a.currentTime+=1/30,await We(a,"seeked"),await new Promise((e=>requestAnimationFrame(e))),n&&n((a.currentTime-e.start)/(e.end-e.start));a.remove()},Ye=async(e,t,r)=>{for(let n=0;n<30*e.length;n++){const a=t.getImageData(0,0,t.canvas.width,t.canvas.height),o=Ve(a,e.shift);t.putImageData(o,0,0),await new Promise((e=>requestAnimationFrame(e))),r&&r(n/e.length)}},Ke=async(e,t,r)=>{for(let n=0;n<e.shifts.length;n++){const a=e.shifts[n],o=t.getImageData(0,0,t.canvas.width,t.canvas.height),i=Ve(o,a);t.putImageData(i,0,0),await new Promise((e=>requestAnimationFrame(e))),r&&r(n/e.shifts.length)}},Je=async e=>{const t=URL.createObjectURL(e.file),r=document.createElement("video");return r.src=t,await We(r,"canplay"),{...e,src:t,previewing:!1,width:r.videoWidth,height:r.videoHeight}};let Ge;const Qe=({videos:e,setVideos:t,segments:r,setSegments:a})=>{const o=(r,n)=>{e[r].previewing=n,t([...e])};return n.r.createElement("div",{className:"Videos"},0===e.length?n.r.createElement("p",null,"No video uploaded yet"):e.map(((i,s)=>n.r.createElement("div",{key:i.key,className:"media"},n.r.createElement("video",{className:"thumb",src:i.src,muted:!0,loop:!0,autoPlay:!0,title:`preview ${i.file.name}`,onClick:()=>{o(s,!0)}}),n.r.createElement("span",{className:"name",title:i.file.name},`${i.width}x${i.height} ${i.file.name}`),n.r.createElement("button",{className:"u-icon-button",type:"button",title:"delete",onClick:()=>{(async n=>{var o;await(o=e[n].key,new Promise(((e,t)=>{const r=Ge.transaction("files","readwrite").objectStore("files").delete(o);r.onerror=t,r.onsuccess=()=>e()})));const i=r.filter((t=>t.src!==e[n].src));i.length<r.length&&a(i),URL.revokeObjectURL(e[n].src),e.splice(n,1),t([...e])})(s)}},n.r.createElement("img",{src:"/icons/delete.svg",alt:"delete video"})),i.previewing&&n.r.createElement(Fe,{onClose:()=>{o(s,!1)}},n.r.createElement("video",{className:"preview",src:i.src,autoPlay:!0,controls:!0,loop:!0}))))),n.r.createElement("div",null,"Add video: ",n.r.createElement("input",{type:"file",accept:"video/*",onInput:async r=>{const n=r.target.files[0],a=await(e=>new Promise(((t,r)=>{const n=Ge.transaction("files","readwrite").objectStore("files").add({file:e});n.onerror=r,n.onsuccess=()=>t(n.result)})))(n),o=await Je({key:a,file:n});t([...e,o]),r.target.value=""}})))},Xe=({segment:e,onChange:t})=>{const[r,s]=i(!1),[c,l]=i(e.start),[u,m]=i(e.end),f=o(null),p=o(null),d=o(null),h=o(0),v=()=>{if(p.current){if(u===c)return p.current.currentTime=c,void p.current.pause();p.current.currentTime=c,p.current.paused&&p.current.play(),h.current=window.setTimeout(v,1e3*(u-c))}};return a((()=>{p.current&&(h.current&&clearTimeout(h.current),v())}),[c,u,r]),n.r.createElement("div",{className:"StartEndInput"},n.r.createElement("button",{type:"button",className:"u-normal-button display-button",onClick:()=>s(!0)},`${e.start}s - ${e.end}s`),r&&n.r.createElement(Fe,{onClose:()=>s(!1)},n.r.createElement("div",{className:"modal-content"},n.r.createElement("div",{className:"videos"},n.r.createElement("div",null,n.r.createElement("div",null,n.r.createElement("video",{src:e.src,ref:f})),n.r.createElement("div",null,`Start: ${c}s`),n.r.createElement("div",null,n.r.createElement("input",{type:"range",min:"0",max:p.current?.duration,step:"0.1",value:c,onChange:e=>{return t=+e.target.value,l(t),f.current.currentTime=t,void(t>u&&(m(t),d.current.currentTime=t));var t}}))),n.r.createElement("div",null,n.r.createElement("video",{src:e.src,ref:p,muted:!0}),n.r.createElement("div",null,`Duration: ${(u-c).toFixed(1)}s`)),n.r.createElement("div",null,n.r.createElement("video",{src:e.src,ref:d}),n.r.createElement("div",null,`End: ${u}s`),n.r.createElement("div",null,n.r.createElement("input",{type:"range",min:"0",max:p.current?.duration,step:"0.1",value:u,onChange:e=>{return t=+e.target.value,m(t),d.current.currentTime=t,void(t<c&&(l(t),f.current.currentTime=t));var t}})))),n.r.createElement("div",{className:"buttons"},n.r.createElement("button",{type:"button",className:"u-normal-button cancel",onClick:()=>{s(!1),l(e.start),m(e.end)}},"Cancel"),n.r.createElement("button",{type:"button",className:"u-normal-button save",onClick:()=>{s(!1),t(c,u)}},"Save")))))},et=({segment:e,onChange:t})=>{const[r,a]=i(!1),[s,c]=i(e.time),[l,u]=i(e.length),m=o(null);return n.r.createElement("div",{className:"TimeLengthInput"},n.r.createElement("button",{type:"button",className:"u-normal-button display-button",onClick:()=>a(!0)},`${e.time}s, ${e.length}s`),r&&n.r.createElement(Fe,{onClose:()=>a(!1)},n.r.createElement("div",{className:"modal-content"},n.r.createElement("video",{src:e.src,ref:m}),n.r.createElement("div",null,`Time: ${s}s`),n.r.createElement("div",null,n.r.createElement("input",{type:"range",min:"0",max:m.current?.duration,step:"0.1",value:s,onChange:e=>{return t=+e.target.value,c(t),void(m.current.currentTime=t);var t}})),n.r.createElement("div",null,`Length: ${l.toFixed(1)}s`),n.r.createElement("div",null,n.r.createElement("input",{type:"range",min:"0",max:"10",step:"0.1",value:l,onChange:e=>{return t=+e.target.value,void u(t);var t}})),n.r.createElement("div",{className:"buttons"},n.r.createElement("button",{type:"button",className:"u-normal-button cancel",onClick:()=>{a(!1),c(e.time),u(e.length)}},"Cancel"),n.r.createElement("button",{type:"button",className:"u-normal-button save",onClick:()=>{a(!1),t(s,l)}},"Save")))))},tt=({videos:e,segments:t,setSegments:r})=>n.r.createElement("div",{className:"Segments"},0===e.length?n.r.createElement("p",null,"Add videos to be able to define segments"):n.r.createElement(n.r.Fragment,null,0===t.length?n.r.createElement("p",null,"No segments defined"):t.map(((a,o)=>n.r.createElement("div",{className:"row",key:o},n.r.createElement("button",{className:"u-icon-button",type:"button",style:{visibility:o>0?"visible":"hidden"},onClick:()=>(e=>{t.splice(e-1,2,t[e],t[e-1]),r([...t])})(o)},n.r.createElement("img",{src:"/icons/up.svg",alt:""})),n.r.createElement("button",{className:"u-icon-button",type:"button",style:{visibility:o<t.length-1?"visible":"hidden"},onClick:()=>(e=>{t.splice(e,2,t[e+1],t[e]),r([...t])})(o)},n.r.createElement("img",{src:"/icons/down.svg",alt:""})),n.r.createElement("button",{className:"u-icon-button",type:"button",onClick:()=>(e=>{t.splice(e,1),r([...t])})(o)},n.r.createElement("img",{src:"/icons/delete.svg",alt:""})),n.r.createElement("select",{className:"transform",value:a.transform,onInput:e=>((e,n)=>{switch(n){case"copy":t[e]={transform:"copy",src:t[e].src,start:0,end:0};break;case"glide":t[e]={transform:"glide",src:t[e].src,time:0,length:0};break;case"movement":t[e]={transform:"movement",src:t[e].src,start:0,end:0}}r([...t])})(o,e.target.value)},n.r.createElement("option",{value:"copy"},"copy"),n.r.createElement("option",{value:"glide"},"glide"),n.r.createElement("option",{value:"movement"},"movement")),("copy"===a.transform||"movement"===a.transform)&&n.r.createElement(Xe,{segment:a,onChange:(e,n)=>((e,n,a)=>{t[e].start=n,t[e].end=a,r([...t])})(o,e,n)}),"glide"===a.transform&&n.r.createElement(et,{segment:a,onChange:(e,n)=>((e,n,a)=>{t[e].time=n,t[e].length=a,r([...t])})(o,e,n)}),n.r.createElement("select",{className:"src",value:a.src,onInput:e=>((e,n)=>{t[e].src=n,r([...t])})(o,e.target.value)},e.map((e=>n.r.createElement("option",{key:e.key,value:e.src},e.file.name))))))),n.r.createElement("div",null,n.r.createElement("button",{type:"button",className:"u-normal-button",onClick:()=>{r([...t,{transform:"copy",src:e[0].src,start:0,end:0}])}},"Add a segment")))),rt=({segments:e,setOutput:t})=>{const r=o(null),[a,s]=i(!1),[l,u]=i(null),[m,f]=i([]),[p,d]=i([]);return n.r.createElement("div",{className:"Render"},l&&n.r.createElement("p",null,l),a?n.r.createElement(n.r.Fragment,null,n.r.createElement("p",null,"Rendering in progress..."),n.r.createElement("div",null,m.map(((t,r)=>n.r.createElement("div",{key:r},n.r.createElement("progress",{value:t}),`Preparing segment ${r}/${e.length} (${e[r].transform})`)))),n.r.createElement("div",null,p.map(((t,r)=>n.r.createElement("div",{key:r},n.r.createElement("progress",{value:t}),`Running segment ${r}/${e.length} (${e[r].transform})`)))),n.r.createElement("p",null,"Don't mind the weird stuff happening below")):n.r.createElement("button",{type:"button",className:"u-normal-button",onClick:async()=>{try{m.splice(0,m.length,...e.map((()=>0))),f([...m]),p.splice(0,m.length,...e.map((()=>0))),d([...p]),s(!0),u(null),c.Z.track("begin render",{segments:e});const n=performance.now(),{width:a,height:o}=await(async e=>{const t=await Promise.all(e.map((async e=>{const t=document.createElement("video");return t.src=e.src,await We(t,"canplay"),{width:t.videoWidth,height:t.videoHeight}}))),r=new Set(t.map((e=>e.width))),n=new Set(t.map((e=>e.height)));if(r.size>1||n.size>1)throw new Error("Videos do not all have the same dimensions");return{width:[...r][0],height:[...n][0]}})(e);for(let t=0;t<e.length;t++){const r=e[t];if(("copy"===r.transform||"movement"===r.transform)&&r.end-r.start==0||"glide"===r.transform&&0===r.time)throw new Error("Segment has a duration of 0s")}const i=[];for(let t=0;t<e.length;t++){const n=e[t];switch(n.transform){case"copy":m[t]=.5,f([...m]),i.push(n),m[t]=1,f([...m]);break;case"glide":m[t]=.5,f([...m]),i.push(await He(n,r.current)),m[t]=1,f([...m]);break;case"movement":m[t]=0,f([...m]),i.push(await ze(n,r.current,(e=>{m[t]=e,f([...m])}))),m[t]=1,f([...m])}}const l=document.createElement("canvas");l.width=a,l.height=o,r.current.append(l);const h=l.getContext("2d");h.clearRect(0,0,a,o);const v=l.captureStream(),g=new MediaRecorder(v);g.start();for(let e=0;e<i.length;e++){const t=i[e];switch(t.transform){case"copy":p[e]=0,d([...p]),await Ze(t,h,r.current,(t=>{p[e]=t,d([...p])})),p[e]=1,d([...p]);break;case"glide":p[e]=0,d([...p]),await Ye(t,h,(t=>{p[e]=t,d([...p])})),p[e]=1,d([...p]);break;case"movement":p[e]=0,d([...p]),await Ke(t,h,(t=>{p[e]=t,d([...p])})),p[e]=1,d([...p])}}g.addEventListener("dataavailable",(async e=>{const r=URL.createObjectURL(e.data),i=l.toDataURL("image/png"),u=+(await fetch(i)).headers.get("Content-Length");t({width:a,height:o,videoUrl:r,videoType:e.data.type,videoSize:e.data.size,imageUrl:i,imageSize:u}),l.remove(),s(!1),c.Z.track("end render",{time:(performance.now()-n)/1e3})}),{once:!0}),g.stop()}catch(e){c.Z.track("render error",{message:e.message}),u(e.message),s(!1)}}},"render"),n.r.createElement("div",{ref:r}))},nt=e=>e<1024?`${e}b`:e<1048576?`${Math.floor(e/1024)}Kb`:`${Math.floor(e/1024)}Mb`,at=({output:e})=>{const[t,r]=i(!1),[a,o]=i(0),[s,c]=i(!1);if(null===e)return n.r.createElement("div",{className:"Result-empty"},n.r.createElement("p",null,"No output yet rendered"));const l=[a>=3600&&`${Math.floor(a/3600)}h`,a>=60&&`${Math.floor(a%3600/60)}mn`,`${Math.floor(a%60)}s`].filter(Boolean).join(""),u=nt(e.videoSize),m=nt(e.imageSize);return n.r.createElement("div",{className:"Result-done"},n.r.createElement("div",{className:"desc"},n.r.createElement("div",null,"Video"),n.r.createElement("div",null,`${e.width}x${e.height}`),n.r.createElement("div",null,l),n.r.createElement("div",null,u),n.r.createElement("div",null,`type: ${e.videoType}`)),n.r.createElement("div",null,n.r.createElement("video",{className:"thumb",src:e.videoUrl,muted:!0,autoPlay:!0,loop:!0,onClick:()=>r(!0),title:"Click to preview",onCanPlay:e=>o(e.target.duration)})),n.r.createElement("div",{className:"desc"},n.r.createElement("div",null,"Last frame"),n.r.createElement("div",null,`${e.width}x${e.height}`),n.r.createElement("div",null,m),n.r.createElement("div",null,`type: ${e.imageUrl.split(";")[0].split(":")[1]}`),e.imageUrl.length),n.r.createElement("div",null,n.r.createElement("img",{className:"thumb",src:e.imageUrl,alt:"",onClick:()=>c(!0)})),t&&n.r.createElement(Fe,{onClose:()=>r(!1)},n.r.createElement("video",{className:"preview",src:e.videoUrl,autoPlay:!0,controls:!0,loop:!0})),s&&n.r.createElement(Fe,{onClose:()=>c(!1)},n.r.createElement("img",{className:"preview",src:e.imageUrl,alt:""})))},ot=()=>{const[e,t]=i([]),[r,s]=i([]),[l,u]=i(null),m=o(!0);return a((()=>{(async()=>{const e=await new Promise(((e,t)=>{const r=Ge.transaction("files","readonly").objectStore("files").getAll();r.onerror=t,r.onsuccess=()=>e(r.result)}));if(e.length&&window.confirm("Restore previous work?")){c.Z.track("restored previous work");const r=await Promise.all(e.map(Je));t(r);const n=await new Promise(((e,t)=>{const r=Ge.transaction("segments","readonly").objectStore("segments").getAll();r.onerror=t,r.onsuccess=()=>e(r.result)}));for(const e of n)e.src=r.find((t=>t.key===e.savedFileKey)).src,delete e.savedFileKey;s(n)}else e.length&&c.Z.track("ignored previous work restored"),await Promise.all([new Promise(((e,t)=>{const r=Ge.transaction("files","readwrite").objectStore("files").clear();r.onerror=t,r.onsuccess=()=>e()})),new Promise(((e,t)=>{const r=Ge.transaction("segments","readwrite").objectStore("segments").clear();r.onerror=t,r.onsuccess=()=>e()}))])})()}),[]),a((()=>{(async()=>{if(m.current)return void(m.current=!1);const t=r.map((t=>({...t,savedFileKey:e.find((e=>e.src===t.src)).key})));await(e=>new Promise(((t,r)=>{const n=Ge.transaction("segments","readwrite");n.onabort=r,n.onerror=r,n.oncomplete=t;const a=n.objectStore("segments");a.clear();for(const t of e)a.add(t)})))(t)})()}),[r]),a((()=>c.Z.track("update videos",{dimensions:e.map((e=>({width:e.width,height:e.height})))})),[e]),a((()=>c.Z.track("update segments",{segments:r})),[r]),n.r.createElement("div",{className:"Studio"},n.r.createElement(Qe,{videos:e,setVideos:t,segments:r,setSegments:s}),n.r.createElement(tt,{videos:e,segments:r,setSegments:s}),n.r.createElement(rt,{segments:r,setOutput:u}),n.r.createElement(at,{output:l}))},it=()=>{const e=Ne(we).location;return a((()=>{c.Z.track("navigation",{pathname:e.pathname})}),[e]),n.r.createElement("div",{className:"App"},n.r.createElement("nav",null,n.r.createElement(Ae,{to:"/"},n.r.createElement("img",{src:"/icons/home.svg",alt:"home icon"})),n.r.createElement(Ae,{to:"/studio"},n.r.createElement("img",{src:"/icons/studio.svg",alt:"studio icon"})),n.r.createElement(Ae,{to:"/about"},n.r.createElement("img",{src:"/icons/info.svg",alt:"info icon"}))),n.r.createElement(_e,null,n.r.createElement(Se,{path:"/studio"},n.r.createElement(ot,null)),n.r.createElement(Se,{path:"/about"},n.r.createElement(Ue,null)),n.r.createElement(Se,{path:"/"},n.r.createElement(Le,null))))},st=()=>n.r.createElement($e,null,n.r.createElement(it,null));(async()=>{c.Z.init("eaea796d6217c6d87165d71ff1a82e0b",{debug:!0}),c.Z.track("start"),await new Promise(((e,t)=>{const r=indexedDB.open("db");r.onerror=t,r.onblocked=t,r.onupgradeneeded=()=>{Ge=r.result,Ge.createObjectStore("files",{keyPath:"key",autoIncrement:!0}),Ge.createObjectStore("segments",{autoIncrement:!0})},r.onsuccess=()=>{Ge=r.result,e()}})),s.Z.render(n.r.createElement(st,null),document.querySelector("#root"))})()}},e=>{e.O(0,[170,282],(()=>(367,e(e.s=367)))),e.O()}]);